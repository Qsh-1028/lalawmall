{"version":3,"sources":["webpack:///src/pages/kefu/chat.vue","webpack:///./src/pages/kefu/chat.vue?1a99","webpack:///./src/pages/kefu/chat.vue"],"names":["__webpack_exports__","data","relation","fansopenid","orderid","chat","status","kefu","fans","order","id","chatlog","min","psize","loading","finished","content","fastReply","faseReplyMsg","orders","websocket","heartCheck","others","voice","popup","showPreLoading","islegal","methods","onLoad","that","this","Object","__WEBPACK_IMPORTED_MODULE_3__controller_funcCommon__","vue","url","kefuunionid","success","result","util","extend","concat","__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_toConsumableArray___default","reply","logs","length","setWXTitle","nickname","onLoadMore","$nextTick","$toast","chatid","onSendMessage","type","push","log","hasSendOrder","onConfirmFastReply","onTogglePopup","onUploadImage","e","mask","message","duration","image","obj","filename","clear","options","channel","onScrollBottom","setTimeout","chatLogDom","$refs","scrollTop","scrollHeight","onToggleStatus","key","x","onSetNotreadZero","console","onOrderClick","orderId","onShowOrders","initWebSocket","timeout","timeoutObj","serverTimeoutObj","reset","clearTimeout","start","self","readyState","send","__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify___default","close","WebSocket","__WEBPACK_IMPORTED_MODULE_4__config_env__","onopen","websocketOnopen","onmessage","websocketOnmessage","onerror","websocketOnerror","onclose","websocketOnclose","eval","onBindClientId","clientId","client_id","mounted","query","parseQuery","$route","destroyed","updated","components","PublicHeader","__WEBPACK_IMPORTED_MODULE_2__components_header__","computed","chatLogBottom","bottom","kefu_chat","render","_vm","_h","$createElement","_c","_self","attrs","title","_v","staticClass","isonline","_s","online_cn","_e","on","click","$event","jsTel","mobile","mobile_cn","ref","style","refresh","model","value","callback","$$v","$set","expression","_l","chatlogItem","index","class","left","isleft","right","addtime_cn","src","avatar","alt","jsPreviewImage","jsUrl","logo","status_cn","goods_title","Lang","dollarSign","final_fee","dollarSignCn","directives","name","rawName","placeholder","domProps","keyup","_k","keyCode","input","target","composing","item","multiple","accept","change","reason","rows","position","van-hairline--top","staticRenderFns","__vue_styles__","ssrContext","__webpack_require__","Component","normalizeComponent"],"mappings":"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","file":"static/js/4.c4f39e2fb63b810d1fc7.js","sourcesContent":["<template>\r\n\t<div id=\"kefu-chat\">\r\n\t\t<public-header :title=\"fans.nickname\"></public-header>\r\n\t\t<div class=\"content font-14\">\r\n\t\t\t<div class=\"connection\">\r\n\t\t\t\t<div class=\"status\" v-if=\"fans.isonline == 1\">{{fans.online_cn}}</div>\r\n\t\t\t\t<div class=\"call flex c-info\" v-if=\"fans.mobile\">\r\n\t\t\t\t\t<div class=\"flex\" @click=\"util.jsTel(fans.mobile)\">\r\n\t\t\t\t\t\t<i class=\"icon icon-telephone\"></i>\r\n\t\t\t\t\t\t<span>{{fans.mobile_cn}}</span>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t<div class=\"chatlog\" :style=\"{bottom: chatLogBottom + 'px'}\" ref=\"chatlog\">\r\n\t\t\t\t<van-pull-refresh v-model=\"chatlog.loading\" @refresh=\"onLoadMore()\">\r\n\t\t\t\t\t<template v-if=\"chatlog.data.length > 0\">\r\n\t\t\t\t\t\t<template v-for=\"(chatlogItem, index) in chatlog.data\">\r\n\t\t\t\t\t\t\t<div class=\"log-item\" :class=\"{left: chatlogItem.isleft == 1, right: chatlogItem.isleft == 0}\">\r\n\t\t\t\t\t\t\t\t<div class=\"time flex-center margin-15-b\" v-if=\"chatlogItem.addtime_cn\">\r\n\t\t\t\t\t\t\t\t\t<span>{{chatlogItem.addtime_cn}}</span>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t<div class=\"detail\">\r\n\t\t\t\t\t\t\t\t\t<div class=\"avatar\">\r\n\t\t\t\t\t\t\t\t\t\t<img class=\"img-100\" :src=\"chatlogItem.avatar\" alt=\"\">\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t<div class=\"text before\" v-if=\"chatlogItem.type == 'text'\">{{chatlogItem.content}}</div>\r\n\t\t\t\t\t\t\t\t\t<div class=\"image\" @click=\"util.jsPreviewImage(chatlogItem.content)\" v-else-if=\"chatlogItem.type == 'image'\">\r\n\t\t\t\t\t\t\t\t\t\t<img :src=\"chatlogItem.content\" alt=\"\">\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t<div class=\"order before\" v-else-if=\"chatlogItem.type == 'orderTakeout'\" @click=\"util.jsUrl('pages/order/detail', {id: chatlogItem.orderid});\">\r\n\t\t\t\t\t\t\t\t\t\t<div class=\"c-gray\">订单信息</div>\r\n\t\t\t\t\t\t\t\t\t\t<div class=\"flex-lr margin-10-t\">\r\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"store-logo\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<img class=\"img-100\" :src=\"chatlogItem.content.logo\" alt=\"\">\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"order-info\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"flex-lr\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"store-title ellipsis\">{{chatlogItem.content.title}}</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"order-status font-12 ellipsis\">{{chatlogItem.content.status_cn}}</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"flex-lr c-gray\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"goods-title ellipsis\">{{chatlogItem.content.goods_title}}</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"order-fee font-12 ellipsis\">实付<span class=\"c-default\">{{Lang.dollarSign}}{{chatlogItem.content.final_fee}}{{Lang.dollarSignCn}}</span></div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t<div class=\"status\" :class=\"{'not-read': chatlogItem.isread == 0}\" v-if=\"0\">{{chatlogItem.isread == 0 ? '未读' : '已读'}}</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</template>\r\n\t\t\t\t\t</template>\r\n\t\t\t\t\t<div class=\"log-item center\" v-if=\"0\">\r\n\t\t\t\t\t\t<div class=\"tips\">商家可能正在忙，未能及时回复，请直接的电话联系</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</van-pull-refresh>\r\n\t\t\t</div>\r\n\t\t\t<div class=\"tools\" v-if=\"chat.status == 1\">\r\n\t\t\t\t<div class=\"guess flex padding-15-lr padding-10-tb van-hairline--bottom\">\r\n\t\t\t\t\t<span class=\"c-gray margin-10-r\">猜你喜欢</span>\r\n\t\t\t\t\t<ul class=\"guess-list\">\r\n\t\t\t\t\t\t<li class=\"guess-item\" @click=\"onShowOrders()\">最近订单</li>\r\n\t\t\t\t\t</ul>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=\"main flex-lr\">\r\n\t\t\t\t\t<i class=\"icon icon-voicefill margin-15-r\" @click=\"onSendMessage()\" v-if=\"0\"></i>\r\n\t\t\t\t\t<input v-model=\"content\" type=\"text\" class=\"text\" placeholder=\"输入消息...\" @keyup.enter=\"onSendMessage()\">\r\n\t\t\t\t\t<i class=\"icon icon-sort margin-15-lr\" @click=\"onToggleStatus('fastReply')\"></i>\r\n\t\t\t\t\t<i class=\"icon icon-add\" @click=\"onToggleStatus('others')\" v-if=\"!content\"></i>\r\n\t\t\t\t\t<div class=\"btn-send\" @click=\"onSendMessage()\" v-else>发送</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<ul class=\"common-reply van-hairline--top\" v-if=\"status.fastReply\">\r\n\t\t\t\t\t<template v-for=\"(item, index) in fastReply\">\r\n\t\t\t\t\t\t<li class=\"reply-item van-hairline--bottom\" @click=\"onSendMessage(item, 'text')\">{{item}}</li>\r\n\t\t\t\t\t</template>\r\n\t\t\t\t\t<li class=\"reply-item flex-center c-info\">\r\n\t\t\t\t\t\t<i class=\"icon icon-add font-18 margin-5-r\"></i>\r\n\t\t\t\t\t\t<span @click=\"onTogglePopup('fastReply')\">添加常用语</span>\r\n\t\t\t\t\t</li>\r\n\t\t\t\t</ul>\r\n\t\t\t\t<ul class=\"others\" v-if=\"status.others\">\r\n\t\t\t\t\t<li class=\"other-item\">\r\n\t\t\t\t\t\t<div class=\"other-item-inner\">\r\n\t\t\t\t\t\t\t<input class=\"weui-uploader__input\" type=\"file\" multiple=\"multiple\" accept=\"image/*\" @change=\"onUploadImage($event)\">\r\n\t\t\t\t\t\t\t<i class=\"icon icon-pic-filling\"></i>\r\n\t\t\t\t\t\t\t<span class=\"margin-10-t\">照片</span>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</li>\r\n\t\t\t\t</ul>\r\n\t\t\t</div>\r\n\t\t\t<div class=\"close-tips ellipsis van-hairline--top\" v-else>{{chat.reason}}</div>\r\n\t\t</div>\r\n\t\t<van-popup v-model=\"popup.fastReply\" class=\"fast-reply-popup\">\r\n\t\t\t<div class=\"title\">添加快捷短语</div>\r\n\t\t\t<van-field\r\n\t\t\t\tv-model=\"faseReplyMsg\"\r\n\t\t\t\ttype=\"textarea\"\r\n\t\t\t\tplaceholder=\"例如: 我不能吃辣, 麻烦少放些辣椒\"\r\n\t\t\t\trows=\"4\"\r\n\t\t\t\tclass=\"border-0px\"\r\n\t\t\t/>\r\n\t\t\t<div class=\"flex-center van-hairline--top\">\r\n\t\t\t\t<div class=\"flex-1 flex-center padding-15-tb van-hairline--right\" @click=\"onTogglePopup('fastReply')\">取消</div>\r\n\t\t\t\t<div class=\"flex-1 flex-center padding-15-tb c-gray\" @click=\"onConfirmFastReply\">确认添加</div>\r\n\t\t\t</div>\r\n\t\t</van-popup>\r\n\t\t<van-popup v-model=\"popup.order\" position=\"bottom\" class=\"order-list-popup\">\r\n\t\t\t<div class=\"title padding-15 flex-lr van-hairline--bottom\">\r\n\t\t\t\t<div class=\"font-15\">点击发送订单<span class=\"c-gray font-12 margin-10-l\">展示最近5个订单</span></div>\r\n\t\t\t\t<i class=\"icon icon-close font-20\" @click=\"onTogglePopup('order')\"></i>\r\n\t\t\t</div>\r\n\t\t\t<div class=\"popup-content\">\r\n\t\t\t\t<div\r\n\t\t\t\t\tclass=\"order-item padding-15-l bg-default font-15\"\r\n\t\t\t\t\tv-for=\"(item, index) in orders\"\r\n\t\t\t\t\t:key=\"item.id\"\r\n\t\t\t\t\t@click=\"onOrderClick(item.id)\"\r\n\t\t\t\t>\r\n\t\t\t\t\t<div class=\"item-inner \" :class=\"{'van-hairline--top': index > 0}\">\r\n\t\t\t\t\t\t<div class=\"store-logo\">\r\n\t\t\t\t\t\t\t<img class=\"img-100\" :src=\"item.logo\" alt=\"\">\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div class=\"info\">\r\n\t\t\t\t\t\t\t<div class=\"flex-lr w-100\">\r\n\t\t\t\t\t\t\t\t<div class=\"store-title ellipsis\">{{item.title}}</div>\r\n\t\t\t\t\t\t\t\t<div class=\"order-status ellipsis\">{{item.status_cn}}</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<div class=\"flex-lr c-gray padding-10-t\">\r\n\t\t\t\t\t\t\t\t<div class=\"goods-title ellipsis\">{{item.goods_title}}</div>\r\n\t\t\t\t\t\t\t\t<div class=\"order-fee ellipsis\">\r\n\t\t\t\t\t\t\t\t\t实付<span class=\"c-default\">{{Lang.dollarSign}}{{item.final_fee}}</span>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=\"flex-center padding-15 van-hairline--top c-danger bg-default font-15\" v-if=\"0\">查看全部订单</div>\r\n\t\t\t</div>\r\n\t\t</van-popup>\r\n\t\t<iloading v-if=\"showPreLoading\"></iloading>\r\n\t</div>\r\n</template>\r\n\r\n<script>\r\n\timport PublicHeader from '@/components/header'\r\n\timport {getData, setData} from '@/controller/funcCommon'\r\n\timport { wssUrl } from \"@/config/env\"\r\n\texport default {\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\trelation: 'member2clerk',\r\n\t\t\t\tfansopenid: 0,\r\n\t\t\t\torderid: 0,\r\n\r\n\t\t\t\tchat: {\r\n\t\t\t\t\tstatus: 1\r\n\t\t\t\t},\r\n\t\t\t\tkefu: {},\r\n\t\t\t\tfans: {},\r\n\t\t\t\torder: {\r\n\t\t\t\t\tid: 0,\r\n\t\t\t\t},\r\n\t\t\t\tchatlog: {\r\n\t\t\t\t\tmin: 0,\r\n\t\t\t\t\tpsize: 100,\r\n\t\t\t\t\tloading: false,\r\n\t\t\t\t\tfinished: false,\r\n\t\t\t\t\tdata: []\r\n\t\t\t\t},\r\n\t\t\t\tcontent: '',\r\n\t\t\t\tfastReply: [],\r\n\t\t\t\tfaseReplyMsg: '',\r\n\t\t\t\torders: [],\r\n\t\t\t\twebsocket: {},\r\n\t\t\t\theartCheck: {},\r\n\t\t\t\tstatus: {\r\n\t\t\t\t\tfastReply: false,\r\n\t\t\t\t\tothers: false,\r\n\t\t\t\t\tvoice: false,\r\n\t\t\t\t},\r\n\t\t\t\tpopup: {\r\n\t\t\t\t\tfastReply: false,\r\n\t\t\t\t\torder: false\r\n\t\t\t\t},\r\n\t\t\t\tshowPreLoading: true,\r\n\t\t\t\tislegal: false\r\n\t\t\t}\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\tonLoad() {\r\n\t\t\t\tvar that = this;\r\n\t\t\t\tgetData({\r\n\t\t\t\t\tvue: that,\r\n\t\t\t\t\turl: 'manage/kefu/clerk/chat',\r\n\t\t\t\t\tdata: {\r\n\t\t\t\t\t\trelation: that.relation,\r\n\t\t\t\t\t\tfansopenid: that.fansopenid,\r\n\t\t\t\t\t\tkefuunionid: that.kefuunionid,\r\n\t\t\t\t\t\torderid: that.orderid,\r\n\t\t\t\t\t\tmin: that.chatlog.min,\r\n\t\t\t\t\t\tpsize: that.chatlog.psize\r\n\t\t\t\t\t},\r\n\t\t\t\t\tsuccess: (result) => {\r\n\t\t\t\t\t\tthat.chat = that.util.extend(that.chat, result.chat);\r\n\t\t\t\t\t\tthat.kefu = that.util.extend(that.kefu, result.kefu);\r\n\t\t\t\t\t\tthat.fans = that.util.extend(that.fans, result.fans);\r\n\t\t\t\t\t\tthat.order = that.util.extend(that.order, result.order);\r\n\t\t\t\t\t\tthat.fastReply = [...result.reply];\r\n\t\t\t\t\t\tif(result.chatlog.logs && result.chatlog.logs.length > 0) {\r\n\t\t\t\t\t\t\tthat.chatlog.data = [...result.chatlog.logs];\r\n\t\t\t\t\t\t\tif(result.chatlog.logs.length < that.chatlog.psize) {\r\n\t\t\t\t\t\t\t\tthat.chatlog.finished = true;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tthat.chatlog.min = result.chatlog.min;\r\n\t\t\t\t\t\tif(!that.chatlog.min) {\r\n\t\t\t\t\t\t\tthat.chatlog.finished = true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tthat.util.setWXTitle(that.fans.nickname);\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},\r\n\r\n\t\t\tonLoadMore() {\r\n\t\t\t\tvar that = this;\r\n\t\t\t\tif(that.chatlog.finished) {\r\n\t\t\t\t\tthat.$nextTick(() => {\r\n\t\t\t\t\t\tthat.chatlog.loading = false;\r\n\t\t\t\t\t})\r\n\t\t\t\t\tthat.util.$toast('没有更多消息了');\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t\tgetData({\r\n\t\t\t\t\tvue: that,\r\n\t\t\t\t\turl: 'manage/kefu/clerk/more',\r\n\t\t\t\t\tdata: {\r\n\t\t\t\t\t\tchatid: that.chat.id,\r\n\t\t\t\t\t\tmin: that.chatlog.min,\r\n\t\t\t\t\t\tpsize: that.chatlog.psize\r\n\t\t\t\t\t},\r\n\t\t\t\t\tsuccess: (result) => {\r\n\t\t\t\t\t\tif(result.chatlog.logs && result.chatlog.logs.length > 0) {\r\n\t\t\t\t\t\t\tthat.chatlog.data = result.chatlog.logs.concat(that.chatlog.data);\r\n\t\t\t\t\t\t\tif(result.chatlog.logs.length < that.chatlog.psize) {\r\n\t\t\t\t\t\t\t\tthat.chatlog.finished = true;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tthat.chatlog.min = result.chatlog.min;\r\n\t\t\t\t\t\tif(!that.chatlog.min) {\r\n\t\t\t\t\t\t\tthat.chatlog.finished = true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tthat.chatlog.loading = false;\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},\r\n\r\n\t\t\tonSendMessage(content, type) {\r\n\t\t\t\tvar that = this;\r\n\t\t\t\tif(!that.islegal) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t\tthat.islegal = false;\r\n\t\t\t\tif(!content) {\r\n\t\t\t\t\tcontent = that.content;\r\n\t\t\t\t}\r\n\t\t\t\tif(!type) {\r\n\t\t\t\t\ttype = 'text';\r\n\t\t\t\t}\r\n\t\t\t\tif(!content || content == '') {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t\tsetData({\r\n\t\t\t\t\tvue: that,\r\n\t\t\t\t\turl: 'manage/kefu/clerk/addchat',\r\n\t\t\t\t\tdata: {\r\n\t\t\t\t\t\tchatid: that.chat.id,\r\n\t\t\t\t\t\ttype: type,\r\n\t\t\t\t\t\tcontent: content\r\n\t\t\t\t\t},\r\n\t\t\t\t\tsuccess: (result) => {\r\n\t\t\t\t\t\tthat.chatlog.data.push(result.log);\r\n\t\t\t\t\t\tif(type == 'text') {\r\n\t\t\t\t\t\t\tthat.content = '';\r\n\t\t\t\t\t\t} else if(type == 'orderTakeout') {\r\n\t\t\t\t\t\t\tthat.hasSendOrder = true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},\r\n\r\n\t\t\tonConfirmFastReply() {\r\n\t\t\t\tvar that = this;\r\n\t\t\t\tif(!that.faseReplyMsg || that.faseReplyMsg == '') {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t\tsetData({\r\n\t\t\t\t\tvue: that,\r\n\t\t\t\t\turl: 'manage/kefu/clerk/addreply',\r\n\t\t\t\t\tdata: {\r\n\t\t\t\t\t\tcontent: that.faseReplyMsg,\r\n\t\t\t\t\t\trelation: that.relation,\r\n\t\t\t\t\t},\r\n\t\t\t\t\tsuccess: (result) => {\r\n\t\t\t\t\t\tif(result.reply && result.reply.length > 0) {\r\n\t\t\t\t\t\t\tthat.fastReply = [...result.reply];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tthat.faseReplyMsg = '';\r\n\t\t\t\t\t\tthat.onTogglePopup('fastReply');\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},\r\n\r\n\t\t\tonUploadImage(e) {\r\n\t\t\t\tvar that = this;\r\n\t\t\t\tthat.$toast.loading({\r\n\t\t\t\t\tmask: true,\r\n\t\t\t\t\tmessage: '上传中...',\r\n\t\t\t\t\tduration: 0,\r\n\t\t\t\t});\r\n\t\t\t\tthat.util.image({\r\n\t\t\t\t\tobj: e,\r\n\t\t\t\t\tsuccess: function(obj, result) {\r\n\t\t\t\t\t\tif(result.url && result.filename) {\r\n\t\t\t\t\t\t\tvar content = result.filename;\r\n\t\t\t\t\t\t\tthat.islegal = true;\r\n\t\t\t\t\t\t\tthat.onSendMessage(content, 'image');\r\n\t\t\t\t\t\t\tthat.$toast.clear();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\toptions: {channel: 'h5'}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\r\n\t\t\tonScrollBottom() {\r\n\t\t\t\tvar that = this;\r\n\t\t\t\tthat.islegal = true;\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\tvar chatLogDom = that.$refs.chatlog;\r\n\t\t\t\t\tchatLogDom.scrollTop = chatLogDom.scrollHeight;\r\n\t\t\t\t}, 200);\r\n\t\t\t},\r\n\r\n\t\t\tonToggleStatus(key) {\r\n\t\t\t\tvar that = this;\r\n\t\t\t\tfor(var x in that.status) {\r\n\t\t\t\t\tif(x == key) {\r\n\t\t\t\t\t\tthat.status[x] = !that.status[x];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthat.status[x] = false;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\tonTogglePopup(key) {\r\n\t\t\t\tif(!key) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t\tvar that = this;\r\n\t\t\t\tthat.popup[key] = !that.popup[key];\r\n\t\t\t},\r\n\r\n\t\t\tonSetNotreadZero() {\r\n\t\t\t\tvar that = this;\r\n\t\t\t\tsetData({\r\n\t\t\t\t\tvue: that,\r\n\t\t\t\t\turl: 'manage/kefu/clerk/zero',\r\n\t\t\t\t\tdata: {\r\n\t\t\t\t\t\tchatid: that.chat.id\r\n\t\t\t\t\t},\r\n\t\t\t\t\tsuccess: (result) => {\r\n\t\t\t\t\t\tconsole.log('清零成功');\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},\r\n\r\n\t\t\tonOrderClick(orderId) {\r\n\t\t\t\tvar that = this;\r\n\t\t\t\tif(orderId > 0) {\r\n\t\t\t\t\tthat.onSendMessage(orderId, 'orderTakeout');\r\n\t\t\t\t\tthat.onTogglePopup('order');\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\tonShowOrders() {\r\n\t\t\t\tvar that = this;\r\n\t\t\t\tgetData({\r\n\t\t\t\t\tvue: that,\r\n\t\t\t\t\turl: 'manage/kefu/clerk/order',\r\n\t\t\t\t\tdata: {\r\n\t\t\t\t\t\tchatid: that.chat.id,\r\n\t\t\t\t\t},\r\n\t\t\t\t\tsuccess: (result) => {\r\n\t\t\t\t\t\tvar orders = result.orders;\r\n\t\t\t\t\t\tif(orders && orders.length > 0) {\r\n\t\t\t\t\t\t\tthat.orders = [...orders];\r\n\t\t\t\t\t\t\tthat.onTogglePopup('order');\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tthat.util.$toast('该顾客最近未在您的门店下过单')\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},\r\n\r\n\t\t\tinitWebSocket(){\r\n\t\t\t\tvar that = this;\r\n\t\t\t\t//设置心跳检测相关属性\r\n\t\t\t\tvar heartCheck = {\r\n\t\t\t\t\ttimeout: 20000,//毫秒\r\n\t\t\t\t\ttimeoutObj: null,\r\n\t\t\t\t\tserverTimeoutObj: null,\r\n\t\t\t\t\treset: function(){\r\n\t\t\t\t\t\tthis.timeoutObj && clearTimeout(this.timeoutObj);\r\n\t\t\t\t\t\tthis.serverTimeoutObj && clearTimeout(this.serverTimeoutObj);\r\n\t\t\t\t\t\treturn this;\r\n\t\t\t\t\t},\r\n\t\t\t\t\tstart: function(){\r\n\t\t\t\t\t\tvar self = this;\r\n\t\t\t\t\t\tthis.reset();\r\n\t\t\t\t\t\tthis.timeoutObj = setTimeout(function(){\r\n\t\t\t\t\t\t\t//这里发送一个心跳，后端收到后，返回一个心跳消息，\r\n\t\t\t\t\t\t\t//onmessage拿到返回的心跳就说明连接正常\r\n\t\t\t\t\t\t\tvar pingData = {\r\n\t\t\t\t\t\t\t\ttype: 'ping',\r\n\t\t\t\t\t\t\t\tdata: {}\r\n\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\tif(that.websocket.readyState == 1) {\r\n\t\t\t\t\t\t\t\tthat.websocket.send(JSON.stringify(pingData));\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tself.serverTimeoutObj = setTimeout(function(){//如果超过一定时间还没重置，说明后端主动断开了\r\n\t\t\t\t\t\t\t\tthat.websocket.close();\r\n\t\t\t\t\t\t\t}, self.timeout)\r\n\t\t\t\t\t\t}, this.timeout)\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tthat.heartCheck = heartCheck;\r\n\t\t\t\t//WebSocket连接\r\n\t\t\t\tthat.websocket = new WebSocket(wssUrl);\r\n\t\t\t\tthat.websocket.onopen = that.websocketOnopen;\r\n\t\t\t\tthat.websocket.onmessage = that.websocketOnmessage;\r\n\t\t\t\tthat.websocket.onerror = that.websocketOnerror;\r\n\t\t\t\tthat.websocket.onclose = that.websocketOnclose;\r\n\t\t\t},\r\n\t\t\twebsocketOnopen(e){ //连接成功\r\n\t\t\t\tvar that = this;\r\n\t\t\t\tthat.heartCheck.start();\r\n\t\t\t\tconsole.log('webSocket init success');\r\n\t\t\t},\r\n\t\t\twebsocketOnerror(e){//连接建立失败重连\r\n\t\t\t\tvar that = this;\r\n\t\t\t\tthat.initWebSocket()\r\n\t\t\t},\r\n\t\t\twebsocketOnmessage(e){\r\n\t\t\t\tvar that = this;\r\n\t\t\t\tthat.heartCheck.start();\r\n\t\t\t\tvar data = eval(\"(\"+e.data+\")\");\r\n\t\t\t\tconsole.log(data)\r\n\t\t\t\tvar type = data.type;\r\n\t\t\t\tvar result = data.data;\r\n\t\t\t\tswitch(type) {\r\n\t\t\t\t\tcase 'connect':\r\n\t\t\t\t\t\tthat.onBindClientId(result.clientId);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'message':\r\n\t\t\t\t\t\tif(that.chat.id == result.chat.chatid) {\r\n\t\t\t\t\t\t\tthat.chatlog.data.push(result.chat);\r\n\t\t\t\t\t\t\tthat.onSetNotreadZero();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'ping':\r\n\t\t\t\t\t\tconsole.log('心跳反馈')\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tdefault:\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\twebsocketOnclose(e){  //关闭\r\n\t\t\t\tconsole.log('webSocket close');\r\n\t\t\t},\r\n\t\t\tonBindClientId(clientId) {\r\n\t\t\t\tvar that = this;\r\n\t\t\t\tif(!clientId) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t\tsetData({\r\n\t\t\t\t\tvue: that,\r\n\t\t\t\t\turl: 'manage/kefu/bind/clerk',\r\n\t\t\t\t\tdata: {\r\n\t\t\t\t\t\tclient_id: clientId\r\n\t\t\t\t\t},\r\n\t\t\t\t\tsuccess: (result) => {\r\n\r\n\t\t\t\t\t},\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t},\r\n\t\tmounted() {\r\n\t\t\tvar that = this;\r\n\t\t\tvar query = that.util.parseQuery(that.$route.query);\r\n\t\t\tthat.relation =  query.relation;\r\n\t\t\tthat.fansopenid = query.fansopenid;\r\n\t\t\tthat.kefuunionid = query.kefuunionid;\r\n\t\t\tthat.orderid = query.orderid;\r\n\t\t\tthat.onLoad();\r\n\t\t\tthat.initWebSocket();\r\n\t\t},\r\n\t\tdestroyed() {\r\n\t\t\t//页面销毁时关闭websocket连接\r\n\t\t\tvar that = this;\r\n\t\t\tthat.websocket.close();\r\n\t\t},\r\n\t\tupdated(){\r\n\t\t\tvar that = this;\r\n\t\t\tthat.onScrollBottom();\r\n\t\t},\r\n\t\tcomponents: {\r\n\t\t\tPublicHeader,\r\n\t\t},\r\n\t\tcomputed: {\r\n\t\t\tchatLogBottom: function() {\r\n\t\t\t\tvar that = this;\r\n\t\t\t\tvar bottom = 96;\r\n\t\t\t\tif(that.chat.status == 2) {\r\n\t\t\t\t\tbottom = 56;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif(that.status.fastReply) {\r\n\t\t\t\t\t\tbottom = 272;\r\n\t\t\t\t\t} else if(that.status.others) {\r\n\t\t\t\t\t\tbottom = 237;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn bottom;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style>\r\n\t@import \"../../../static/css/test.css\";\r\n\t#kefu-chat .connection{\r\n\t\tposition: absolute;\r\n\t\ttop: 0;\r\n\t\tleft: 0;\r\n\t\tright: 0;\r\n\t\theight: 44px;\r\n\t\tbackground-color: #fff;\r\n\t\tpadding: 10px 15px;\r\n\t\tfont-size: 14px;\r\n\t\ttext-align: center;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\t}\r\n\t#kefu-chat .connection .status{\r\n\t\tposition: absolute;\r\n\t\ttop: 10px;\r\n\t\tleft: 15px;\r\n\t\tpadding: 5px 5px 5px 15px;\r\n\t\tbackground-color: rgba(32,203,135,0.1);\r\n\t\tcolor: #20cb87;\r\n\t}\r\n\t#kefu-chat .connection .status:before{\r\n\t\tcontent: '';\r\n\t\tposition: absolute;\r\n\t\ttop: 9px;\r\n\t\tleft: 5px;\r\n\t\twidth: 6px;\r\n\t\theight: 6px;\r\n\t\tborder-radius: 50%;\r\n\t\tbackground-color: #20cb87;\r\n\t}\r\n\t#kefu-chat .tools{\r\n\t\tposition: absolute;\r\n\t\tz-index: 11;\r\n\t\tleft: 0;\r\n\t\tright: 0;\r\n\t\tbottom: 0;\r\n\t\tbackground-color: #fff;\r\n\t}\r\n\t#kefu-chat .tools .guess .guess-list{\r\n\t\tflex: 1;\r\n\t\tdisplay: flex;\r\n\t\tflex-flow: row nowrap;\r\n\t\talign-items: center;\r\n\t\tjustify-content: flex-start;\r\n\t}\r\n\t#kefu-chat .tools .guess .guess-list .guess-item{\r\n\t\tborder: 1px solid #f0f0f0;\r\n\t\tpadding: 4px 10px;\r\n\t\tborder-radius: 50px;\r\n\t\tfont-size: 13px;\r\n\t\tcolor: #333;\r\n\t\tmargin-right: 10px;\r\n\t}\r\n\t#kefu-chat .tools .main{\r\n\t\tpadding: 10px 15px;\r\n\t}\r\n\t#kefu-chat .tools .main .icon{\r\n\t\tfont-size: 18px;\r\n\t}\r\n\t#kefu-chat .tools .main .text{\r\n\t\tflex: 1;\r\n\t\theight: 33px;\r\n\t\tpadding: 0 15px;\r\n\t\tborder-radius: 50px;\r\n\t\tbackground: #f5f5f5;\r\n\t}\r\n\t#kefu-chat .tools .common-reply{\r\n\t\theight: 176px;\r\n\t\toverflow-y: scroll;\r\n\t\t-webkit-overflow-scrolling: touch;\r\n\t}\r\n\t#kefu-chat .tools .common-reply::-webkit-scrollbar {\r\n\t\tdisplay: none;\r\n\t}\r\n\t#kefu-chat .tools .common-reply .reply-item{\r\n\t\tpadding: 15px;\r\n\t\ttext-align: center;\r\n\t\toverflow: hidden;\r\n\t\ttext-overflow: ellipsis;\r\n\t\twhite-space: nowrap;\r\n\t}\r\n\t#kefu-chat .tools .others{\r\n\t\theight: 141px;\r\n\t\tdisplay: flex;\r\n\t\tflex-flow: row wrap;\r\n\t\tbackground-color: #f5f5f5;\r\n\t\tpadding-bottom: 15px;\r\n\t}\r\n\t#kefu-chat .tools .others .other-item{\r\n\t\twidth: 25%;\r\n\t\theight: 63px;\r\n\t\tdisplay: flex;\r\n\t\tflex-flow: column nowrap;\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\t\tpadding-top: 15px;\r\n\t}\r\n\t#kefu-chat .tools .others .other-item .other-item-inner{\r\n\t\tdisplay: flex;\r\n\t\tflex-flow: column nowrap;\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\t\tposition: relative;\r\n\t}\r\n\t#kefu-chat .tools .others .other-item .other-item-inner .weui-uploader__input{\r\n\t\tdisplay: block;\r\n\t\tposition: absolute;\r\n\t\twidth: 100%;\r\n\t\theight: 100%;\r\n\t\ttop: 0;\r\n\t\tleft: 0;\r\n\t\topacity: 0;\r\n\t}\r\n\t#kefu-chat .tools .others .other-item .icon{\r\n\t\tfont-size: 24px;\r\n\t}\r\n\t#kefu-chat .chatlog{\r\n\t\tposition: absolute;\r\n\t\ttop: 44px;\r\n\t\tleft: 0;\r\n\t\tright: 0;\r\n\t\tbottom: 53px;\r\n\t\tpadding: 0 15px 15px 15px;\r\n\t\toverflow-y: scroll;\r\n\t\t-webkit-overflow-scrolling: touch;\r\n\t}\r\n\t#kefu-chat .chatlog::-webkit-scrollbar {\r\n\t\tdisplay: none;\r\n\t}\r\n\t#kefu-chat .chatlog .log-item{\r\n\t\tmargin-top: 15px;\r\n\t}\r\n\t#kefu-chat .chatlog .log-item .time span{\r\n\t\tcolor: #f8f8f8;\r\n\t\tbackground-color: #cecece;\r\n\t\tfont-size: 12px;\r\n\t\tpadding: 4px 5px;\r\n\t\tborder-radius: 5px;\r\n\t}\r\n\t#kefu-chat .chatlog .log-item .detail{\r\n\t\tdisplay: flex;\r\n\t\talign-items: flex-start;\r\n\t}\r\n\t#kefu-chat .chatlog .log-item.left .detail{\r\n\t\tflex-flow: row nowrap;\r\n\t\tpadding-right: 40px;\r\n\t}\r\n\t#kefu-chat .chatlog .log-item.right .detail{\r\n\t\tflex-flow: row-reverse nowrap;\r\n\t\tpadding-left: 40px;\r\n\t}\r\n\t#kefu-chat .chatlog .log-item .detail .text{\r\n\t\tposition: relative;\r\n\t\tbackground-color: #fff;\r\n\t\tpadding: 10px;\r\n\t\tborder-radius: 5px;\r\n\t\tline-height: 1.3;\r\n\t\tmargin: 0 10px 0 10px;\r\n\t}\r\n\t#kefu-chat .chatlog .log-item.right .detail .text{\r\n\t\tbackground-color: #33aafc;\r\n\t\tcolor: #fff;\r\n\t}\r\n\t#kefu-chat .chatlog .log-item .detail .avatar{\r\n\t\tmin-width: 40px;\r\n\t\twidth: 40px;\r\n\t\theight: 40px;\r\n\t\tborder-radius: 50%;\r\n\t\toverflow: hidden;\r\n\t}\r\n\t#kefu-chat .chatlog .log-item .detail .status{\r\n\t\talign-self: flex-end;\r\n\t\twhite-space: nowrap;\r\n\t\tfont-size: 12px;\r\n\t\tcolor: #999;\r\n\t\tpadding-bottom: 3px;\r\n\t}\r\n\t#kefu-chat .chatlog .log-item .detail .status.not-read{\r\n\t\tcolor: #33aafc;\r\n\t}\r\n\t#kefu-chat .chatlog .log-item .detail .before:before{\r\n\t\tcontent: \"\";\r\n\t\tdisplay: block;\r\n\t\tborder-width: 8px;\r\n\t\tposition: absolute;\r\n\t\ttop: 12px;\r\n\t\tborder-style: solid dashed dashed;\r\n\t\tfont-size: 0;\r\n\t\tline-height: 0;\r\n\t\tz-index: 10;\r\n\t}\r\n\t#kefu-chat .chatlog .log-item.left .detail .before:before{\r\n\t\tleft: -16px;\r\n\t\ttransform: rotate(90deg);\r\n\t\tborder-color: #fff transparent transparent;\r\n\t}\r\n\t#kefu-chat .chatlog .log-item.right .detail .before:before{\r\n\t\tright: -16px;\r\n\t\ttransform: rotate(-90deg);\r\n\t\tborder-color: #33aafc transparent transparent;\r\n\t}\r\n\t#kefu-chat .chatlog .log-item .detail .order{\r\n\t\tposition: relative;\r\n\t\tpadding: 10px;\r\n\t\tflex: 1;\r\n\t\tmargin: 0 10px;\r\n\t\tborder-radius: 5px;\r\n\t\tbackground-color: #fff;\r\n\t\tborder: 3px solid #33aafc;\r\n\t}\r\n\t#kefu-chat .chatlog .log-item.left .detail .order{\r\n\t\tborder-color: #fff;\r\n\t}\r\n\t#kefu-chat .chatlog .log-item .detail .order .store-logo{\r\n\t\twidth: 40px;\r\n\t\theight: 40px;\r\n\t\tborder-radius: 50%;\r\n\t\toverflow: hidden;\r\n\t\tmin-width: 40px;\r\n\t}\r\n\t#kefu-chat .chatlog .log-item .detail .order .order-info{\r\n\t\tposition: absolute;\r\n\t\tright: 10px;\r\n\t\tbottom: 10px;\r\n\t\tleft: 50px;\r\n\t\theight: 40px;\r\n\t\tpadding-left: 10px;\r\n\t\tdisplay: flex;\r\n\t\tflex-flow: column nowrap;\r\n\t\tjustify-content: space-between;\r\n\t}\r\n\t#kefu-chat .chatlog .log-item .detail .order .order-info .store-title{\r\n\t\twidth: 40%;\r\n\t}\r\n\t#kefu-chat .chatlog .log-item .detail .order .order-info .order-status{\r\n\t\twidth: 60%;\r\n\t\ttext-align: right;\r\n\t\tcolor: #20cb87;\r\n\t}\r\n\t#kefu-chat .chatlog .log-item .detail .order .order-info .goods-title{\r\n\t\twidth: 50%;\r\n\t}\r\n\t#kefu-chat .chatlog .log-item .detail .order .order-info .order-fee{\r\n\t\twidth: 50%;\r\n\t\ttext-align: right;\r\n\t}\r\n\t#kefu-chat .chatlog .log-item .detail .image{\r\n\t\tmax-width: 100%;\r\n\t\tborder-radius: 5px;\r\n\t\toverflow: hidden;\r\n\t\tfont-size: 0px;\r\n\t\tmargin: 0 10px;\r\n\t}\r\n\t#kefu-chat .chatlog .log-item .detail .image img{\r\n\t\tmax-height: 100px;\r\n\t\twidth: auto;\r\n\t\tmax-width: 100%;\r\n\t}\r\n\t#kefu-chat .chatlog .log-item.center{\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\t}\r\n\t#kefu-chat .chatlog .log-item .tips{\r\n\t\tcolor: #f8f8f8;\r\n\t\tbackground-color: #cecece;\r\n\t\tfont-size: 12px;\r\n\t\tpadding: 4px 10px;\r\n\t\tborder-radius: 5px;\r\n\t\tline-height: 1.2;\r\n\t}\r\n\t#kefu-chat .chatlog .order-card{\r\n\t\twidth: 100%;\r\n\t\t/*padding: 15px;*/\r\n\t\tborder-radius: 5px;\r\n\t\tbackground-color: #fff;\r\n\t\tposition: relative;\r\n\t}\r\n\t#kefu-chat .chatlog .order-card .store-logo{\r\n\t\twidth: 40px;\r\n\t\theight: 40px;\r\n\t\tborder-radius: 50%;\r\n\t\toverflow: hidden;\r\n\t\tmin-width: 40px;\r\n\t}\r\n\t#kefu-chat .chatlog .order-card .order-info{\r\n\t\tposition: absolute;\r\n\t\tright: 15px;\r\n\t\ttop: 15px;\r\n\t\tleft: 55px;\r\n\t\theight: 40px;\r\n\t\tpadding-left: 10px;\r\n\t\tdisplay: flex;\r\n\t\tflex-flow: column nowrap;\r\n\t\tjustify-content: space-between;\r\n\t}\r\n\t#kefu-chat .chatlog .order-card .order-info .store-title, #kefu-chat .chatlog .order-card .order-info .goods-title{\r\n\t\tmax-width: 60%;\r\n\t}\r\n\t#kefu-chat .chatlog .order-card .order-info .order-status, #kefu-chat .chatlog .order-card .order-info .order-fee{\r\n\t\tmax-width: 40%;\r\n\t}\r\n\t#kefu-chat .chatlog .order-card .order-info .order-status{\r\n\t\tcolor: #20cb87;\r\n\t}\r\n\t#kefu-chat .chatlog .order-card .send{\r\n\t\tcolor: #33aafc;\r\n\t\tpadding: 15px 0;\r\n\t}\r\n\t#kefu-chat .fast-reply-popup{\r\n\t\twidth: 80%;\r\n\t\tborder-radius: 5px;\r\n\t\toverflow: hidden;\r\n\t}\r\n\t#kefu-chat .fast-reply-popup .title{\r\n\t\ttext-align: center;\r\n\t\tpadding: 15px 0 5px;\r\n\t}\r\n\t#kefu-chat .fast-reply-popup textarea{\r\n\t\tbackground-color: #f5f5f5;\r\n\t\tpadding: 5px 10px;\r\n\t\tborder-radius: 3px;\r\n\t}\r\n\t#kefu-chat .close-tips{\r\n\t\tposition: absolute;\r\n\t\tleft: 0;\r\n\t\tright: 0;\r\n\t\tbottom: 0;\r\n\t\theight: 56px;\r\n\t\tline-height: 56px;\r\n\t\tpadding: 0 15px;\r\n\t\tbackground-color: #f3f3f3;\r\n\t\tcolor: #9b9b9b;\r\n\t\ttext-align: center;\r\n\t\tfont-size: 16px;\r\n\t}\r\n\t#kefu-chat .tools .btn-send{\r\n\t\tpadding: 0px 10px;\r\n\t\theight: 33px;\r\n\t\tline-height: 33px;\r\n\t\tborder-radius: 5px;\r\n\t\tbackground-color: #33aafc;\r\n\t\tcolor: #fff;\r\n\t}\r\n\t#kefu-chat .order-list-popup .popup-content{\r\n\t\theight: 320px;\r\n\t\toverflow-y: scroll;\r\n\t\t-webkit-overflow-scrolling: touch;\r\n\t\tbackground-color: #f5f5f5;\r\n\t}\r\n\t#kefu-chat .order-list-popup .popup-content::-webkit-scrollbar {\r\n\t\tdisplay: none;\r\n\t}\r\n\t#kefu-chat .order-list-popup .order-item .item-inner{\r\n\t\tpadding: 15px 15px 15px 0;\r\n\t\tposition: relative;\r\n\t}\r\n\t#kefu-chat .order-list-popup .order-item .store-logo{\r\n\t\twidth: 50px;\r\n\t\theight: 50px;\r\n\t\tborder-radius: 50%;\r\n\t\toverflow: hidden;\r\n\t}\r\n\t#kefu-chat .order-list-popup .order-item .info{\r\n\t\tposition: absolute;\r\n\t\ttop: 15px;\r\n\t\tright: 15px;\r\n\t\tbottom: 15px;\r\n\t\tleft: 65px;\r\n\t\tdisplay: flex;\r\n\t\tflex-flow: column nowrap;\r\n\t\tjustify-content: center;\r\n\t}\r\n\t#kefu-chat .order-list-popup .order-item .info .store-title, .order-list-popup .order-item .info .goods-title{\r\n\t\twidth: 65%;\r\n\t}\r\n\t#kefu-chat .order-list-popup .order-item .info .order-status, .order-list-popup .order-item .info .order-fee{\r\n\t\twidth: 35%;\r\n\t\ttext-align: right;\r\n\t}\r\n\t#kefu-chat .order-list-popup .order-item .info .order-status{\r\n\t\tfont-size: 14px;\r\n\t\tcolor: #20cb87;\r\n\t}\r\n</style>\n\n\n// WEBPACK FOOTER //\n// src/pages/kefu/chat.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"kefu-chat\"}},[_c('public-header',{attrs:{\"title\":_vm.fans.nickname}}),_vm._v(\" \"),_c('div',{staticClass:\"content font-14\"},[_c('div',{staticClass:\"connection\"},[(_vm.fans.isonline == 1)?_c('div',{staticClass:\"status\"},[_vm._v(_vm._s(_vm.fans.online_cn))]):_vm._e(),_vm._v(\" \"),(_vm.fans.mobile)?_c('div',{staticClass:\"call flex c-info\"},[_c('div',{staticClass:\"flex\",on:{\"click\":function($event){_vm.util.jsTel(_vm.fans.mobile)}}},[_c('i',{staticClass:\"icon icon-telephone\"}),_vm._v(\" \"),_c('span',[_vm._v(_vm._s(_vm.fans.mobile_cn))])])]):_vm._e()]),_vm._v(\" \"),_c('div',{ref:\"chatlog\",staticClass:\"chatlog\",style:({bottom: _vm.chatLogBottom + 'px'})},[_c('van-pull-refresh',{on:{\"refresh\":function($event){_vm.onLoadMore()}},model:{value:(_vm.chatlog.loading),callback:function ($$v) {_vm.$set(_vm.chatlog, \"loading\", $$v)},expression:\"chatlog.loading\"}},[(_vm.chatlog.data.length > 0)?[_vm._l((_vm.chatlog.data),function(chatlogItem,index){return [_c('div',{staticClass:\"log-item\",class:{left: chatlogItem.isleft == 1, right: chatlogItem.isleft == 0}},[(chatlogItem.addtime_cn)?_c('div',{staticClass:\"time flex-center margin-15-b\"},[_c('span',[_vm._v(_vm._s(chatlogItem.addtime_cn))])]):_vm._e(),_vm._v(\" \"),_c('div',{staticClass:\"detail\"},[_c('div',{staticClass:\"avatar\"},[_c('img',{staticClass:\"img-100\",attrs:{\"src\":chatlogItem.avatar,\"alt\":\"\"}})]),_vm._v(\" \"),(chatlogItem.type == 'text')?_c('div',{staticClass:\"text before\"},[_vm._v(_vm._s(chatlogItem.content))]):(chatlogItem.type == 'image')?_c('div',{staticClass:\"image\",on:{\"click\":function($event){_vm.util.jsPreviewImage(chatlogItem.content)}}},[_c('img',{attrs:{\"src\":chatlogItem.content,\"alt\":\"\"}})]):(chatlogItem.type == 'orderTakeout')?_c('div',{staticClass:\"order before\",on:{\"click\":function($event){_vm.util.jsUrl('pages/order/detail', {id: chatlogItem.orderid});}}},[_c('div',{staticClass:\"c-gray\"},[_vm._v(\"订单信息\")]),_vm._v(\" \"),_c('div',{staticClass:\"flex-lr margin-10-t\"},[_c('div',{staticClass:\"store-logo\"},[_c('img',{staticClass:\"img-100\",attrs:{\"src\":chatlogItem.content.logo,\"alt\":\"\"}})]),_vm._v(\" \"),_c('div',{staticClass:\"order-info\"},[_c('div',{staticClass:\"flex-lr\"},[_c('div',{staticClass:\"store-title ellipsis\"},[_vm._v(_vm._s(chatlogItem.content.title))]),_vm._v(\" \"),_c('div',{staticClass:\"order-status font-12 ellipsis\"},[_vm._v(_vm._s(chatlogItem.content.status_cn))])]),_vm._v(\" \"),_c('div',{staticClass:\"flex-lr c-gray\"},[_c('div',{staticClass:\"goods-title ellipsis\"},[_vm._v(_vm._s(chatlogItem.content.goods_title))]),_vm._v(\" \"),_c('div',{staticClass:\"order-fee font-12 ellipsis\"},[_vm._v(\"实付\"),_c('span',{staticClass:\"c-default\"},[_vm._v(_vm._s(_vm.Lang.dollarSign)+_vm._s(chatlogItem.content.final_fee)+_vm._s(_vm.Lang.dollarSignCn))])])])])])]):_vm._e(),_vm._v(\" \"),(0)?_c('div',{staticClass:\"status\",class:{'not-read': chatlogItem.isread == 0}},[_vm._v(_vm._s(chatlogItem.isread == 0 ? '未读' : '已读'))]):_vm._e()])])]})]:_vm._e(),_vm._v(\" \"),(0)?_c('div',{staticClass:\"log-item center\"},[_c('div',{staticClass:\"tips\"},[_vm._v(\"商家可能正在忙，未能及时回复，请直接的电话联系\")])]):_vm._e()],2)],1),_vm._v(\" \"),(_vm.chat.status == 1)?_c('div',{staticClass:\"tools\"},[_c('div',{staticClass:\"guess flex padding-15-lr padding-10-tb van-hairline--bottom\"},[_c('span',{staticClass:\"c-gray margin-10-r\"},[_vm._v(\"猜你喜欢\")]),_vm._v(\" \"),_c('ul',{staticClass:\"guess-list\"},[_c('li',{staticClass:\"guess-item\",on:{\"click\":function($event){_vm.onShowOrders()}}},[_vm._v(\"最近订单\")])])]),_vm._v(\" \"),_c('div',{staticClass:\"main flex-lr\"},[(0)?_c('i',{staticClass:\"icon icon-voicefill margin-15-r\",on:{\"click\":function($event){_vm.onSendMessage()}}}):_vm._e(),_vm._v(\" \"),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.content),expression:\"content\"}],staticClass:\"text\",attrs:{\"type\":\"text\",\"placeholder\":\"输入消息...\"},domProps:{\"value\":(_vm.content)},on:{\"keyup\":function($event){if(!('button' in $event)&&_vm._k($event.keyCode,\"enter\",13,$event.key,\"Enter\")){ return null; }_vm.onSendMessage()},\"input\":function($event){if($event.target.composing){ return; }_vm.content=$event.target.value}}}),_vm._v(\" \"),_c('i',{staticClass:\"icon icon-sort margin-15-lr\",on:{\"click\":function($event){_vm.onToggleStatus('fastReply')}}}),_vm._v(\" \"),(!_vm.content)?_c('i',{staticClass:\"icon icon-add\",on:{\"click\":function($event){_vm.onToggleStatus('others')}}}):_c('div',{staticClass:\"btn-send\",on:{\"click\":function($event){_vm.onSendMessage()}}},[_vm._v(\"发送\")])]),_vm._v(\" \"),(_vm.status.fastReply)?_c('ul',{staticClass:\"common-reply van-hairline--top\"},[_vm._l((_vm.fastReply),function(item,index){return [_c('li',{staticClass:\"reply-item van-hairline--bottom\",on:{\"click\":function($event){_vm.onSendMessage(item, 'text')}}},[_vm._v(_vm._s(item))])]}),_vm._v(\" \"),_c('li',{staticClass:\"reply-item flex-center c-info\"},[_c('i',{staticClass:\"icon icon-add font-18 margin-5-r\"}),_vm._v(\" \"),_c('span',{on:{\"click\":function($event){_vm.onTogglePopup('fastReply')}}},[_vm._v(\"添加常用语\")])])],2):_vm._e(),_vm._v(\" \"),(_vm.status.others)?_c('ul',{staticClass:\"others\"},[_c('li',{staticClass:\"other-item\"},[_c('div',{staticClass:\"other-item-inner\"},[_c('input',{staticClass:\"weui-uploader__input\",attrs:{\"type\":\"file\",\"multiple\":\"multiple\",\"accept\":\"image/*\"},on:{\"change\":function($event){_vm.onUploadImage($event)}}}),_vm._v(\" \"),_c('i',{staticClass:\"icon icon-pic-filling\"}),_vm._v(\" \"),_c('span',{staticClass:\"margin-10-t\"},[_vm._v(\"照片\")])])])]):_vm._e()]):_c('div',{staticClass:\"close-tips ellipsis van-hairline--top\"},[_vm._v(_vm._s(_vm.chat.reason))])]),_vm._v(\" \"),_c('van-popup',{staticClass:\"fast-reply-popup\",model:{value:(_vm.popup.fastReply),callback:function ($$v) {_vm.$set(_vm.popup, \"fastReply\", $$v)},expression:\"popup.fastReply\"}},[_c('div',{staticClass:\"title\"},[_vm._v(\"添加快捷短语\")]),_vm._v(\" \"),_c('van-field',{staticClass:\"border-0px\",attrs:{\"type\":\"textarea\",\"placeholder\":\"例如: 我不能吃辣, 麻烦少放些辣椒\",\"rows\":\"4\"},model:{value:(_vm.faseReplyMsg),callback:function ($$v) {_vm.faseReplyMsg=$$v},expression:\"faseReplyMsg\"}}),_vm._v(\" \"),_c('div',{staticClass:\"flex-center van-hairline--top\"},[_c('div',{staticClass:\"flex-1 flex-center padding-15-tb van-hairline--right\",on:{\"click\":function($event){_vm.onTogglePopup('fastReply')}}},[_vm._v(\"取消\")]),_vm._v(\" \"),_c('div',{staticClass:\"flex-1 flex-center padding-15-tb c-gray\",on:{\"click\":_vm.onConfirmFastReply}},[_vm._v(\"确认添加\")])])],1),_vm._v(\" \"),_c('van-popup',{staticClass:\"order-list-popup\",attrs:{\"position\":\"bottom\"},model:{value:(_vm.popup.order),callback:function ($$v) {_vm.$set(_vm.popup, \"order\", $$v)},expression:\"popup.order\"}},[_c('div',{staticClass:\"title padding-15 flex-lr van-hairline--bottom\"},[_c('div',{staticClass:\"font-15\"},[_vm._v(\"点击发送订单\"),_c('span',{staticClass:\"c-gray font-12 margin-10-l\"},[_vm._v(\"展示最近5个订单\")])]),_vm._v(\" \"),_c('i',{staticClass:\"icon icon-close font-20\",on:{\"click\":function($event){_vm.onTogglePopup('order')}}})]),_vm._v(\" \"),_c('div',{staticClass:\"popup-content\"},[_vm._l((_vm.orders),function(item,index){return _c('div',{key:item.id,staticClass:\"order-item padding-15-l bg-default font-15\",on:{\"click\":function($event){_vm.onOrderClick(item.id)}}},[_c('div',{staticClass:\"item-inner \",class:{'van-hairline--top': index > 0}},[_c('div',{staticClass:\"store-logo\"},[_c('img',{staticClass:\"img-100\",attrs:{\"src\":item.logo,\"alt\":\"\"}})]),_vm._v(\" \"),_c('div',{staticClass:\"info\"},[_c('div',{staticClass:\"flex-lr w-100\"},[_c('div',{staticClass:\"store-title ellipsis\"},[_vm._v(_vm._s(item.title))]),_vm._v(\" \"),_c('div',{staticClass:\"order-status ellipsis\"},[_vm._v(_vm._s(item.status_cn))])]),_vm._v(\" \"),_c('div',{staticClass:\"flex-lr c-gray padding-10-t\"},[_c('div',{staticClass:\"goods-title ellipsis\"},[_vm._v(_vm._s(item.goods_title))]),_vm._v(\" \"),_c('div',{staticClass:\"order-fee ellipsis\"},[_vm._v(\"\\n\\t\\t\\t\\t\\t\\t\\t\\t实付\"),_c('span',{staticClass:\"c-default\"},[_vm._v(_vm._s(_vm.Lang.dollarSign)+_vm._s(item.final_fee))])])])])])])}),_vm._v(\" \"),(0)?_c('div',{staticClass:\"flex-center padding-15 van-hairline--top c-danger bg-default font-15\"},[_vm._v(\"查看全部订单\")]):_vm._e()],2)]),_vm._v(\" \"),(_vm.showPreLoading)?_c('iloading'):_vm._e()],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-e1e6d25c\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/pages/kefu/chat.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true,\\\"publicPath\\\":\\\"../../\\\"}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-e1e6d25c\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./chat.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./chat.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./chat.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-e1e6d25c\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./chat.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/pages/kefu/chat.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}